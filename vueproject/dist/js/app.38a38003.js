(function(){"use strict";var e={9305:function(e,t,s){s(4114);var r=s(5471),o=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[],a={name:"App",components:{}},l=a,n=s(1656),u=(0,n.A)(l,o,i,!1,null,null,null),c=u.exports,d=s(1052),m=s.n(d),p=s(173),g=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"box-card"},[t("h2",[e._v("登录")]),t("el-form",{ref:"ruleForm",staticClass:"login-from",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-position":"left","label-width":"70px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"account"}},[t("el-input",{model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1)],1),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),t("router-link",{attrs:{to:"/register"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("注册")])],1)],1)],1)],1)},h=[],f=s(4335);const b=f.A.create({baseURL:"/",timeout:5e3});b.interceptors.request.use(e=>{const t=/^https?:\/\//i.test(e.url),s=/\.(json|png|jpg|svg|css|js)$/i.test(e.url);return t||s||e.url.startsWith("/api")||(e.url=`/api${e.url.startsWith("/")?e.url:"/"+e.url}`),e},e=>Promise.reject(e));var v=b;const _=e=>v({url:"/identity/login",method:"post",headers:{"Content-Type":"application/json"},data:e});var y={data(){return{ruleForm:{account:"",password:""},loading:!1,rules:{account:[{required:!0,message:"用户名不能为空！",trigger:"blur"}],password:[{required:!0,message:"密码不能为空！",trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("表单验证失败！"),!1;console.log("表单验证成功"),this.handleLogin()})},async handleLogin(){this.loading=!0;try{const e=await _({account:this.ruleForm.account,password:this.ruleForm.password});this.handleLoginSuccess(e)}catch(e){this.handleLoginError(e)}finally{this.loading=!1}},handleLoginSuccess(e){0===e.data.code?(sessionStorage.setItem("userInfo",JSON.stringify(e.data.data)),this.$router.push("/home"),this.$message({message:e.data.msg||"登录成功",type:"success"})):this.$message({message:e.data.msg||"登录失败",type:"warning"})},handleLoginError(e){console.error("Request failed:",e);let t="登录请求失败，请稍后再试。";t=e.response?e.response.data.message||e.response.data.msg||e.response.statusText:e.request?"无法连接到服务器，请检查网络连接":e.message||e.toString(),this.$message({message:t,type:"error"})}}},C=y,w=(0,n.A)(C,g,h,!1,null,"2d8f1385",null),x=w.exports,k=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"box-card"},[t("h2",[e._v("注册")]),t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"account"}},[t("el-input",{model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.ruleForm.confirmPassword,callback:function(t){e.$set(e.ruleForm,"confirmPassword",t)},expression:"ruleForm.confirmPassword"}})],1)],1),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),t("router-link",{attrs:{to:"/login"}},[t("el-button",[e._v("返回")])],1)],1)],1)],1)},D=[],F={data(){var e=(e,t,s)=>{""===t?s(new Error("请输入密码")):t.length<6?s(new Error("密码长度不能少于6位")):(""!==this.ruleForm.confirmPassword&&this.$refs.ruleForm.validateField("confirmPassword"),s())},t=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!==this.ruleForm.password?s(new Error("两次输入密码不一致!")):s()};return{loading:!1,ruleForm:{account:"",password:"",confirmPassword:""},rules:{account:[{required:!0,message:"用户名不能为空！",trigger:"blur"},{min:3,max:16,message:"用户名长度在3到16个字符",trigger:"blur"}],password:[{required:!0,validator:e,trigger:"blur"}],confirmPassword:[{required:!0,validator:t,trigger:"blur"}]}}},methods:{async submitForm(e){try{const t=await this.$refs[e].validate();if(!t)return;this.loading=!0;const s=await register({account:this.ruleForm.account,password:this.ruleForm.password});this.handleRegistrationResponse(s)}catch(t){this.handleRegistrationError(t)}finally{this.loading=!1}},handleRegistrationResponse(e){0===e.data.code?(this.$message({message:"注册成功，请登录",type:"success",duration:2e3}),setTimeout(()=>{this.$router.push("/login")},1500)):this.$message({message:e.data.msg||"注册失败",type:"error",duration:3e3})},handleRegistrationError(e){console.error("注册请求失败:",e);let t="注册请求失败，请稍后再试";e.response&&(t=e.response.data.message||e.response.data.msg||t),this.$message({message:t,type:"error",duration:3e3})},resetForm(e){this.$refs[e].resetFields()}}},$=F,S=(0,n.A)($,k,D,!1,null,"ee128d76",null),I=S.exports,U=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("h1",[e._v("课程列表")]),s.loading?t("div",[e._v("加载中...")]):s.error?t("div",[e._v(e._s(s.error))]):t("div",{ref:"courseContainer",staticClass:"course-container",on:{mouseenter:s.stopAutoScroll,mouseleave:s.startAutoScroll}},e._l(s.courses,function(r){return t("div",{key:r.id,staticClass:"course-item"},[t("h2",[e._v(e._s(r.title))]),t("p",[e._v("类别: "+e._s(r.category))]),t("p",[e._v("开始时间: "+e._s(s.formatDate(r.startTime)))]),t("p",[e._v("结束时间: "+e._s(s.formatDate(r.endTime)))]),t("p",[e._v("描述: "+e._s(r.description))]),r.image?t("img",{attrs:{src:r.image,alt:"课程图片"}}):e._e()])}),0),t("router-link",{attrs:{to:"/profile"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("个人中心")])],1)],1)},T=[];const V=e=>v({url:"/course/allcourse",method:"get",params:{page:e.page-1,size:e.pageSize}}),A=e=>v({url:`/course/${e}`,method:"delete"}),Y=()=>v({url:"/course/",method:"get"}),O=e=>v({url:"/course/availablecourse",method:"get",params:{page:e.page-1,size:e.pageSize}});var L={__name:"home",setup(e){const t=(0,r.ref)([]),s=(0,r.ref)(!0),o=(0,r.ref)(null),i=(0,r.ref)(null);let a=null;(0,r.onMounted)(async()=>{try{const e=await Y();t.value=e.data}catch(e){o.value=e.message}finally{s.value=!1,l()}}),(0,r.onUnmounted)(()=>{a&&clearInterval(a)});const l=()=>{i.value&&(a=setInterval(()=>{i.value.scrollTop+=1,i.value.scrollTop>=i.value.scrollHeight-i.value.clientHeight&&(i.value.scrollTop=0)},20))},n=()=>{a&&clearInterval(a)},u=e=>{const t=new Date(e),s={year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("zh-CN",s)};return{__sfc:!0,courses:t,loading:s,error:o,courseContainer:i,scrollInterval:a,startAutoScroll:l,stopAutoScroll:n,formatDate:u}}},z=L,M=(0,n.A)(z,U,T,!1,null,"64be7e8b",null),j=M.exports,P=function(){var e=this,t=e._self._c;return t("div",[null!==e.user.id?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("欢迎，"+e._s(e.user.account)+"！您的 ID 为 "+e._s(e.user.id))]),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",size:"large"},on:{click:e.logout}},[e._v("登出")])],1)]):t("el-card",{staticClass:"box-card"},[t("h2",[e._v("加载用户信息失败")]),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{size:"large"},on:{click:e.redirectToLogin}},[e._v("重新登录")])],1)]),"admin"===e.user.role?t("div",[t("router-link",{attrs:{to:"/admin-users"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("用户管理")])],1),t("router-link",{attrs:{to:"/admin-courses"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("课题管理")])],1),t("router-link",{attrs:{to:"/review"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("成绩管理")])],1)],1):e._e(),t("div",[t("router-link",{attrs:{to:"/score"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("成绩提交")])],1)],1),t("div",[t("router-link",{attrs:{to:"/home"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("返回主页")])],1)],1)],1)},H=[],E={data(){return{user:{account:"",id:null,role:""},loading:!0}},methods:{logout(){sessionStorage.removeItem("userInfo"),this.$router.push("/login")},redirectToLogin(){this.$router.push("/login")}},mounted(){const e=sessionStorage.getItem("userInfo");this.user=e?JSON.parse(e):{account:"",id:null,role:""},this.loading=!1}},R=E,q=(0,n.A)(R,P,H,!1,null,"5ab24240",null),G=q.exports,N=function(){var e=this,t=e._self._c;return t("div",[e.users.length>0?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("用户管理")]),e._l(e.users,function(s,r){return t("div",{key:s.id,staticClass:"user-item"},[t("p",[e._v("账号："+e._s(s.account)+" | 用户ID："+e._s(s.id))]),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openDialog(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteUser(s.id)}}},[e._v("删除")])],1)])})],2):t("el-card",[t("h2",[e._v("没有用户信息")])]),t("el-dialog",{attrs:{visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[t("h3",[e._v("用户信息")]),t("el-form",{attrs:{model:e.selectedUser,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"账号"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedUser.account,callback:function(t){e.$set(e.selectedUser,"account",t)},expression:"selectedUser.account"}})],1),t("el-form-item",{attrs:{label:"用户ID"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedUser.id,callback:function(t){e.$set(e.selectedUser,"id",t)},expression:"selectedUser.id"}})],1),t("el-form-item",{attrs:{label:"角色"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedUser.role,callback:function(t){e.$set(e.selectedUser,"role",t)},expression:"selectedUser.role"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("确定")])],1)],1),t("div",[t("router-link",{attrs:{to:"/profile"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("返回主页")])],1)],1)],1)},J=[];const W=e=>v({url:"/identity/allaccount",method:"get",params:{page:e.page-1,size:e.pageSize}}),B=e=>v({url:`/identity/${e}`,method:"delete"});var K={data(){return{users:[],dialogVisible:!1,selectedUser:{}}},methods:{async fetchUsers(){console.log(this.$axios);try{const e=await W({page:1,pageSize:10});this.users=e.data||[]}catch(e){console.error("获取用户信息失败:",e),this.users=[]}},openDialog(e){this.selectedUser={...e},this.dialogVisible=!0},closeDialog(){this.dialogVisible=!1},async deleteUser(e){try{const t=await B(e);204===t.status?(this.$message.success("用户删除成功"),this.fetchUsers()):this.$message.error("删除失败")}catch(t){console.error("删除用户失败:",t),this.$message.error("删除失败")}}},mounted(){this.fetchUsers()}},Q=K,X=(0,n.A)(Q,N,J,!1,null,"4f25f8c9",null),Z=X.exports,ee=function(){var e=this,t=e._self._c;return t("div",[e.courses.length>0?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("课题管理")]),e._l(e.courses,function(s,r){return t("div",{key:s.id,staticClass:"course-item"},[t("p",[e._v("课题名称："+e._s(s.title)+" | 课题ID："+e._s(s.id))]),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openDialog(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteCourse(s.id)}}},[e._v("删除")])],1)])})],2):t("el-card",[t("h2",[e._v("没有课题信息")])]),t("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.openUploadDialog}},[e._v("上传课题")]),t("el-dialog",{attrs:{visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[t("h3",[e._v("课题信息")]),t("el-form",{attrs:{model:e.selectedCourse,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"课题名称"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.title,callback:function(t){e.$set(e.selectedCourse,"title",t)},expression:"selectedCourse.title"}})],1),t("el-form-item",{attrs:{label:"课题ID"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.id,callback:function(t){e.$set(e.selectedCourse,"id",t)},expression:"selectedCourse.id"}})],1),t("el-form-item",{attrs:{label:"课题类别"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.category,callback:function(t){e.$set(e.selectedCourse,"category",t)},expression:"selectedCourse.category"}})],1),t("el-form-item",{attrs:{label:"课题描述"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.description,callback:function(t){e.$set(e.selectedCourse,"description",t)},expression:"selectedCourse.description"}})],1),t("el-form-item",{attrs:{label:"开始时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.start_time,callback:function(t){e.$set(e.selectedCourse,"start_time",t)},expression:"selectedCourse.start_time"}})],1),t("el-form-item",{attrs:{label:"结束时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.end_time,callback:function(t){e.$set(e.selectedCourse,"end_time",t)},expression:"selectedCourse.end_time"}})],1),t("el-form-item",{attrs:{label:"更新时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.updated_at,callback:function(t){e.$set(e.selectedCourse,"updated_at",t)},expression:"selectedCourse.updated_at"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("确定")])],1)],1),e.showUploadForm?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("上传课题")]),t("el-form",{attrs:{model:e.newCourse,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"课题名称"}},[t("el-input",{attrs:{placeholder:"请输入课题名称"},model:{value:e.newCourse.title,callback:function(t){e.$set(e.newCourse,"title",t)},expression:"newCourse.title"}})],1),t("el-form-item",{attrs:{label:"课题类别"}},[t("el-input",{attrs:{placeholder:"请输入课题种类"},model:{value:e.newCourse.category,callback:function(t){e.$set(e.newCourse,"category",t)},expression:"newCourse.category"}})],1),t("el-form-item",{attrs:{label:"开始时间"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间"},model:{value:e.newCourse.start_time,callback:function(t){e.$set(e.newCourse,"start_time",t)},expression:"newCourse.start_time"}})],1),t("el-form-item",{attrs:{label:"截止时间"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择截止时间"},model:{value:e.newCourse.end_time,callback:function(t){e.$set(e.newCourse,"end_time",t)},expression:"newCourse.end_time"}})],1),t("el-form-item",{attrs:{label:"课题描述"}},[t("el-input",{attrs:{placeholder:"请输入课题描述"},model:{value:e.newCourse.description,callback:function(t){e.$set(e.newCourse,"description",t)},expression:"newCourse.description"}})],1),t("el-form-item",{attrs:{label:"上传图片"}},[t("el-upload",{attrs:{action:"/api/course/upload",name:"image","file-list":e.imageFileList,"list-type":"picture-card","on-success":e.handleImageUploadSuccess}},[t("el-button",[e._v("点击上传")])],1)],1)],1),t("el-button",{on:{click:function(t){e.showUploadForm=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.uploadCourse}},[e._v("提交课题")])],1):e._e(),t("div",[t("router-link",{attrs:{to:"/profile"}},[t("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"warning"}},[e._v("返回主页")])],1)],1)],1)},te=[],se=s(4353),re=s.n(se),oe={data(){return{courses:[],dialogVisible:!1,selectedCourse:{},showUploadForm:!1,newCourse:{title:"",category:"",start_time:"",end_time:"",description:"",image:""},imageFileList:[]}},methods:{async fetchCourses(){try{const e=await V({page:1,pageSize:10});this.courses=e.data||[]}catch(e){console.error("获取课题信息失败:",e),this.courses=[]}},openDialog(e){this.selectedCourse={...e,start_time:re()(e.start_time).format("YYYY-MM-DD HH:mm:ss"),end_time:re()(e.end_time).format("YYYY-MM-DD HH:mm:ss"),updated_at:re()(e.updated_at).format("YYYY-MM-DD HH:mm:ss")},this.dialogVisible=!0},closeDialog(){this.dialogVisible=!1},async deleteCourse(e){try{const t=await A(e);204===t.status?(this.$message.success("课题删除成功"),this.fetchCourses()):this.$message.error("删除失败")}catch(t){console.error("删除课题失败:",t),this.$message.error("删除失败")}},openUploadDialog(){this.showUploadForm=!0},handleImageUploadSuccess(e,t,s){console.log("图片上传返回：",e);let r="";e&&0===e.code?r=e.data:e&&e.data&&0===e.data.code&&(r=e.data.data),r?(this.newCourse.image=r,this.imageFileList=s,this.$message.success("图片上传成功")):this.$message.error(e.message||e.data&&e.data.message||"图片上传失败")},async uploadCourse(){console.log("提交前的newCourse:",this.newCourse);const e=re()(this.newCourse.start_time).format("YYYY-MM-DDTHH:mm:ss"),t=re()(this.newCourse.end_time).format("YYYY-MM-DDTHH:mm:ss"),s=re()().format("YYYY-MM-DDTHH:mm:ss");if(this.newCourse.title&&this.newCourse.category&&this.newCourse.start_time&&this.newCourse.end_time&&this.newCourse.description&&this.newCourse.image)try{const r=await f.A.post("/api/course/post",{title:this.newCourse.title,category:this.newCourse.category,startTime:e,endTime:t,description:this.newCourse.description,image:this.newCourse.image,createTime:s,updateTime:s});console.log("课题上传响应：",r),0===r.data.code?(this.$message.success("课题上传成功"),this.showUploadForm=!1,this.fetchCourses()):this.$message.error(r.data.message||"课题上传失败")}catch(r){this.$message.error("上传过程中发生错误")}else this.$message.error("请填写所有必填项")}},mounted(){this.fetchCourses()}},ie=oe,ae=(0,n.A)(ie,ee,te,!1,null,"5194a63a",null),le=ae.exports,ne=function(){var e=this,t=e._self._c;return t("div",[e.courses.length>0?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("成绩提交")]),e._l(e.courses,function(s,r){return t("div",{key:s.id,staticClass:"course-item"},[t("p",[e._v("课题名称："+e._s(s.title)+" | 课题ID："+e._s(s.id))]),t("div",{staticClass:"btnGroup"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openViewDialog(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:e.isSubmitted(s.id)?"warning":"success",size:"small"},on:{click:function(t){e.isSubmitted(s.id)?e.openUpdateDialog(s):e.openSubmitDialog(s)}}},[e._v(" "+e._s(e.isSubmitted(s.id)?"更新":"提交")+" ")])],1)])})],2):t("el-card",[t("h2",[e._v("没有课题信息")])]),t("el-dialog",{attrs:{visible:e.viewDialogVisible,width:"50%"},on:{"update:visible":function(t){e.viewDialogVisible=t},close:e.closeViewDialog}},[t("h3",[e._v("课题信息")]),t("el-form",{attrs:{model:e.selectedCourse,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"课题名称"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.title,callback:function(t){e.$set(e.selectedCourse,"title",t)},expression:"selectedCourse.title"}})],1),t("el-form-item",{attrs:{label:"课题ID"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.id,callback:function(t){e.$set(e.selectedCourse,"id",t)},expression:"selectedCourse.id"}})],1),t("el-form-item",{attrs:{label:"课题类别"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.category,callback:function(t){e.$set(e.selectedCourse,"category",t)},expression:"selectedCourse.category"}})],1),t("el-form-item",{attrs:{label:"课题描述"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.description,callback:function(t){e.$set(e.selectedCourse,"description",t)},expression:"selectedCourse.description"}})],1),t("el-form-item",{attrs:{label:"开始时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.start_time,callback:function(t){e.$set(e.selectedCourse,"start_time",t)},expression:"selectedCourse.start_time"}})],1),t("el-form-item",{attrs:{label:"结束时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.end_time,callback:function(t){e.$set(e.selectedCourse,"end_time",t)},expression:"selectedCourse.end_time"}})],1),t("el-form-item",{attrs:{label:"更新时间"}},[t("el-input",{attrs:{disabled:""},model:{value:e.selectedCourse.updated_at,callback:function(t){e.$set(e.selectedCourse,"updated_at",t)},expression:"selectedCourse.updated_at"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeViewDialog}},[e._v("退出")])],1)],1),t("el-dialog",{attrs:{visible:e.submitDialogVisible,title:"成绩提交",width:"40%"},on:{"update:visible":function(t){e.submitDialogVisible=t},close:e.closeSubmitDialog}},[t("el-form",{ref:"submitFormRef",attrs:{model:e.submitForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"课题名称"}},[t("el-input",{attrs:{disabled:""},model:{value:e.submitForm.course_title,callback:function(t){e.$set(e.submitForm,"course_title",t)},expression:"submitForm.course_title"}})],1),t("el-form-item",{attrs:{label:"课题ID"}},[t("el-input",{attrs:{disabled:""},model:{value:e.submitForm.course_id,callback:function(t){e.$set(e.submitForm,"course_id",t)},expression:"submitForm.course_id"}})],1),t("el-form-item",{attrs:{label:"上传图片"}},[t("el-upload",{attrs:{action:"","auto-upload":!1,"file-list":e.fileList,"list-type":"picture",limit:1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("仅作展示，实际提交固定内容")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeSubmitDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确认提交")])],1)],1),t("el-dialog",{attrs:{visible:e.updateDialogVisible,title:"成绩更新",width:"40%"},on:{"update:visible":function(t){e.updateDialogVisible=t},close:e.closeUpdateDialog}},[t("el-form",{ref:"updateFormRef",attrs:{model:e.updateForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"课题名称"}},[t("el-input",{attrs:{disabled:""},model:{value:e.updateForm.course_title,callback:function(t){e.$set(e.updateForm,"course_title",t)},expression:"updateForm.course_title"}})],1),t("el-form-item",{attrs:{label:"课题ID"}},[t("el-input",{attrs:{disabled:""},model:{value:e.updateForm.course_id,callback:function(t){e.$set(e.updateForm,"course_id",t)},expression:"updateForm.course_id"}})],1),t("el-form-item",{attrs:{label:"上传图片"}},[t("el-upload",{attrs:{action:"","auto-upload":!1,"file-list":e.fileList,"list-type":"picture",limit:1}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("仅作展示，实际提交固定内容")])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeUpdateDialog}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdate}},[e._v("确认更新")])],1)],1),t("div",[t("router-link",{attrs:{to:"/profile"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("返回主页")])],1)],1)],1)},ue=[];const ce=(e,t)=>v({url:"/score/exists",method:"get",params:{identityId:e,courseId:t}}),de=e=>v({url:"/score/post",method:"post",data:e}),me=(e,t)=>v({url:`/score/update/${t}`,method:"post",data:e});var pe={data(){return{courses:[],viewDialogVisible:!1,submitDialogVisible:!1,updateDialogVisible:!1,selectedCourse:{},submitForm:{course_id:"",course_title:"",upload_time:""},updateForm:{course_id:"",course_title:"",upload_time:""},fileList:[],submittedCourses:[]}},methods:{async fetchCourses(){try{const e=await O({page:1,size:10});this.courses=e.data||[],await this.checkSubmittedCourses()}catch(e){console.error("获取课题信息失败:",e),this.$message.error("获取课题列表失败，请稍后重试"),this.courses=[]}},async checkSubmittedCourses(){const e=this.getCurrentIdentityId();if(e)for(const t of this.courses){const s=await ce(e,t.id);s.data&&this.submittedCourses.push(t.id)}else this.$message.error("未获取到用户信息，请重新登录")},isSubmitted(e){return this.submittedCourses.includes(e)},openViewDialog(e){this.selectedCourse={...e,start_time:this.formatDateTime(e.start_time),end_time:this.formatDateTime(e.end_time),updated_at:this.formatDateTime(e.updated_at)},this.viewDialogVisible=!0},closeViewDialog(){this.viewDialogVisible=!1},openSubmitDialog(e){this.submitForm={course_id:e.id,course_title:e.title,upload_time:""},this.fileList=[],this.submitDialogVisible=!0},closeSubmitDialog(){this.submitDialogVisible=!1},openUpdateDialog(e){this.updateForm={course_id:e.id,course_title:e.title,upload_time:""},this.fileList=[],this.updateDialogVisible=!0},closeUpdateDialog(){this.updateDialogVisible=!1},formatDateTime(e){return e?new Date(e).toLocaleString():""},async handleSubmit(){try{const e=this.getCurrentIdentityId();if(!e)return void this.$message.error("未获取到用户信息，请重新登录");this.submitForm.upload_time=(new Date).toISOString();const t={course_id:this.submitForm.course_id,identity_id:e,upload_time:this.submitForm.upload_time,image:"test"};await de(t),this.$message.success(`课题 "${this.submitForm.course_title}" 的成绩提交成功！`),this.closeSubmitDialog(),this.fetchCourses()}catch(e){console.error("提交失败:",e);const t=e.response?.data?.message||"成绩提交失败，请重试";this.$message.error(t)}},async handleUpdate(){try{const e=this.getCurrentIdentityId();if(!e)return void this.$message.error("未获取到用户信息，请重新登录");this.updateForm.upload_time=(new Date).toISOString();const t={point:0,is_scored:!1,remark:null};await me(t,this.updateForm.course_id),this.$message.success(`课题 "${this.updateForm.course_title}" 的成绩更新成功！`),this.closeUpdateDialog(),this.fetchCourses()}catch(e){console.error("更新失败:",e);const t=e.response?.data?.message||"成绩更新失败，请重试";this.$message.error(t)}},getCurrentIdentityId(){try{const e=sessionStorage.getItem("userInfo");if(!e)return null;const t=JSON.parse(e);return t.id?Number(t.id):null}catch(e){return console.error("获取用户身份失败:",e),null}}},mounted(){this.fetchCourses()}},ge=pe,he=(0,n.A)(ge,ne,ue,!1,null,"468f493d",null),fe=he.exports,be=function(){var e=this,t=e._self._c;return t("div",[e.unscoredScores.length>0?t("el-card",{staticClass:"box-card"},[t("h2",[e._v("未审核成绩查看")]),t("el-table",{attrs:{data:e.unscoredScores,stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"成绩ID"}}),t("el-table-column",{attrs:{prop:"course.title",label:"课题名称"}}),t("el-table-column",{attrs:{prop:"identity.name",label:"用户姓名"}}),t("el-table-column",{attrs:{prop:"uploadTime",label:"上传时间",formatter:e.formatDateTime}}),t("el-table-column",{attrs:{prop:"score",label:"分数"}}),t("el-table-column",{attrs:{prop:"isScored",label:"是否评分"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.isScored?"是":"否")+" ")]}}],null,!1,1331926087)}),t("el-table-column",{attrs:{prop:"remark",label:"备注"}})],1)],1):t("el-card",[t("h2",[e._v("没有未审核的成绩信息")])]),t("div",[t("router-link",{attrs:{to:"/profile"}},[t("el-button",{staticStyle:{"margin-left":"10px"}},[e._v("返回主页")])],1)],1)],1)},ve=[],_e=(s(8111),s(2489),{data(){return{scores:[],unscoredScores:[]}},methods:{async fetchScores(){try{const e=await f.A.get("http://localhost:8080/api/score/");this.scores=e.data||[],this.unscoredScores=this.scores.filter(e=>!e.isScored)}catch(e){console.error("获取成绩信息失败:",e),this.$message.error("获取成绩列表失败，请稍后重试"),this.scores=[],this.unscoredScores=[]}},formatDateTime(e,t,s){return s?new Date(s).toLocaleString():""}},mounted(){this.fetchScores()}}),ye=_e,Ce=(0,n.A)(ye,be,ve,!1,null,"3b9cae77",null),we=Ce.exports;r["default"].use(p.Ay);const xe=new p.Ay({mode:"history",routes:[{path:"/",redirect:"/login"},{path:"/login",component:x},{path:"/home",component:j},{path:"/register",component:I},{path:"/profile",component:G},{path:"/admin-users",component:Z},{path:"/admin-courses",component:le},{path:"/review",component:we},{path:"/score",component:fe}]});xe.beforeEach((e,t,s)=>{const r=!!sessionStorage.getItem("userInfo");"/login"===e.path||"/register"===e.path||r?s():((0,d.Message)({message:"请先登录！",type:"warning"}),s({path:"/login"}))});var ke=xe,De=s(1021);r["default"].prototype.$axios=f.A,r["default"].config.productionTip=!1,r["default"].use(m()),r["default"].use(p.Ay),r["default"].use(De.A,f.A),new r["default"]({render:e=>e(c),router:ke,data(){return{ruleForm:{account:"",password:""},loading:!1}},methods:{login(){this.loading=!0,(0,f.A)({url:"/api/identity/login",method:"post",headers:{"Content-Type":"application/json"},data:{account:this.ruleForm.account,password:this.ruleForm.password}}).then(e=>{"0"===e.data.code?(sessionStorage.setItem("userInfo",JSON.stringify(e.data.data)),this.$router.push("/home"),this.$message({message:e.data.msg,type:"success"})):this.$message({message:e.data.msg,type:"warning"}),this.loading=!1}).catch(e=>{console.error("Login error:",e),this.loading=!1,this.$message({message:"An error occurred during login.",type:"error"})})}}}).$mount("#app")}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=e,function(){s.amdO={}}(),function(){var e=[];s.O=function(t,r,o,i){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],i=e[c][2];for(var l=!0,n=0;n<r.length;n++)(!1&i||a>=i)&&Object.keys(s.O).every(function(e){return s.O[e](r[n])})?r.splice(n--,1):(l=!1,i<a&&(a=i));if(l){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[r,o,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,a=r[0],l=r[1],n=r[2],u=0;if(a.some(function(t){return 0!==e[t]})){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(n)var c=n(s)}for(t&&t(r);u<a.length;u++)i=a[u],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(c)},r=self["webpackChunkvue_login_demo"]=self["webpackChunkvue_login_demo"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],function(){return s(9305)});r=s.O(r)})();
//# sourceMappingURL=app.38a38003.js.map